# ******************************************************************************
# Pre-requisites
# ******************************************************************************
cat <<"EOF"
Pre-requisites
---

python3
git
aws (w/ credentials configured)
EOF

# give myself a chance to ctrl-c if I realize I'm missing a dependency
sleep 5s

# ******************************************************************************
# Create directories
# ******************************************************************************
mkdir -p ~/src
mkdir -p ~/cloud
mkdir -p ~/cloud/mcqueen.jordan

# ******************************************************************************
# Copy cloud data
# ******************************************************************************
aws s3 sync s3://mcqueen.jordan ~/cloud/mcqueen.jordan/

# ******************************************************************************
# Copy dotfiles not in source control
# ******************************************************************************
cp -a ~/cloud/mcqueen.jordan/dotfiles/. ~

# ******************************************************************************
# Source non-public environment variables
# ******************************************************************************
. ~/.env

# ******************************************************************************
# Clone repos
# ******************************************************************************
git clone https://github.com/mcqueenjordan/cloudhome.git ~/src/cloudhome

# ******************************************************************************
# setup cron stuff
# ******************************************************************************
echo "* * * * * ~/src/cloudhome/cloudhome/cloudhome.py" >> /tmp/cronstate
crontab /tmp/cronstate
rm /tmp/cronstate
